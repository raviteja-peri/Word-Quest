legacy extended iris for xml resource identification legacy extended iris for xml resource identification wc working group note  november  bnf comment style corrected in place  this version httpwwwworgtrnoteleiri latest version httpwwwworgtrleiri previous version editors henry s thompson university of edinburgh ht@infedacuk richard tobin university of edinburgh richard@infedacuk norman walsh mark logic corporation normanwalsh@marklogiccom this document is also available in these nonnormative formats xml copyright   wc mit ercim keio all rights reserved wc liability trademark and document use rules apply abstract for historic reasons some formats have allowed variants of iris that are somewhat less restricted in syntax for example xml system identifiers and wc xml schema anyuris this document provides a definition and a name legacy extended iri or leiri for these variants for easy reference these variants have to be used with care they require further processing before being fully interchangeable as iris new protocols and formats should not use legacy extended iris status of this document this section describes the status of this document at the time of its publication other documents may supersede this document a list of current wc publications and the latest revision of this technical report can be found in the wc technical reports index at httpwwwworgtr this document is a wc working group note it has been developed by the xml core working group part of the xml activity in the wc ubiquitous web domain publication as a working group note does not imply endorsement by the wc membership this is a draft document and may be updated replaced or obsoleted by other documents at any time it is inappropriate to cite this document as other than work in progress please send comments about this document to xmleditor@worg archived this document is very closely based on material from iribis specifically section  abnf for iri references and iris and section  legacy extended iris included here by permission of its authors it is intended to provide a basis for a single normative reference from many xml andor htmlrelated standards in advance of the final publication of iribis as an rfc when that publication occurs this specification will be reissued to reference it in place of the extracts given below this document was produced by a group operating under the  february  wc patent policy wc maintains a public list of any patent disclosures made in connection with the deliverables of the group that page also includes instructions for disclosing a patent an individual who has actual knowledge of a patent which the individual believes contains essential claims must disclose the information in accordance with section  of the wc patent policy table of contents  introduction  notation  legacy extended iri syntax  conversion of legacy extended iris to iris  characters allowed in legacy extended iris but not in iris appendix a references  introduction for historic reasons some formats have allowed variants of iris rfc that are somewhat less restricted in syntax for example xml system identifiers and wc xml schema anyuris this document provides a definition and a name legacy extended iri or leiri for these variants for easier reference these variants have to be used with care they require further processing before being fully interchangeable as iris new protocols and formats should not use legacy extended iris the provisions in this document also apply to legacy extended iri references  notation in this document characters are referenced by using a prefix of u followed by four to six hexadecimal digits in this document the key words must must not required shall shall not should should not recommended may and optional are to be interpreted as described in rfc  legacy extended iri syntax the syntax of legacy extended iris leiris and leiri references is the same as that for iris and iri references except that ucschar is redefined the syntax of this abnf is described in rfc character numbers are taken from the ucs without implying any actual binary encoding terminals in the abnf are characters not bytes for consistency with rfc for iris generic leiri software should not check leiris for conformance to this syntax some productions are ambiguous the firstmatchwins aka greedy algorithm applies for details see rfc productions changed from rfc  leiri  scheme  ihierpart   iquery    ifragment   ihierpart   iauthority ipathabempty  ipathabsolute  ipathrootless  ipathempty  leirireference  leiri  irelativeref  absoluteleiri  scheme  ihierpart   iquery   irelativeref  irelativepart   iquery    ifragment   irelativepart   iauthority ipathabempty  ipathabsolute  ipathnoscheme  ipathempty  iauthority   iuserinfo @  ihost   port   iuserinfo   iunreserved  pctencoded  subdelims     ihost  ipliteral  ipvaddress  iregname  iregname   iunreserved  pctencoded  subdelims   ipath  ipathabempty  begins with  or is empty  ipathabsolute  begins with  but not   ipathnoscheme  begins with a noncolon segment  ipathrootless  begins with a segment  ipathempty  zero characters  ipathabempty    isegment   ipathabsolute    isegmentnz   isegment    ipathnoscheme  isegmentnznc   isegment   ipathrootless  isegmentnz   isegment   ipathempty  ipchar  isegment  ipchar  isegmentnz  ipchar  isegmentnznc   iunreserved  pctencoded  subdelims  @   nonzerolength segment without any colon   ipchar  iunreserved  pctencoded  subdelims    @  iquery   ipchar  iprivate       ifragment   ipchar       iunreserved  alpha  digit      _    ucschar  iprivate  xefff  xeefff  xfffffd  xfffd productions unchanged from rfc  scheme  alpha  alpha  digit         port  digit  ipliteral    ipvaddress  ipvfuture    ipvfuture  v hexdig   unreserved  subdelims     ipvaddress   h   ls    h   ls   h    h   ls    h   h    h   ls    h   h    h   ls    h   h   h  ls    h   h   ls    h   h   h    h   h    h  hexdig  ls   h  h   ipvaddress  ipvaddress  decoctet  decoctet  decoctet  decoctet  decoctet  digit    x digit     digit     x digit     x    pctencoded   hexdig hexdig  unreserved  alpha  digit      _    reserved  gendelims  subdelims  gendelims              @  subdelims                       modified ucschar production  ucschar                       xf  xfdff  xefffd  xffff the restriction on bidirectional formatting characters in section  of rfc is lifted the iprivate production becomes redundant formats that use legacy extended iris may further restrict the characters allowed therein either implicitly by the fact that the format as such does not allow some characters or explicitly an example of a character not allowed implicitly may be the nul character u however all the characters allowed in iris must still be allowed  conversion of legacy extended iris to iris to convert a legacy extended iri reference to an iri reference each character allowed in a legacy extended iri reference but not allowed in an iri reference see  characters allowed in legacy extended iris but not in iris must be percentencoded by applying the following steps convert the character to a sequence of one or more octets using utf rfc convert each octet to hh where hh is the hexadecimal notation of the octet value note that this is identical to the percentencoding mechanism in section  of rfc to reduce variability the hexadecimal notation should use uppercase letters replace the original character with the resulting character sequence that is a sequence of hh triplets conversion from a leiri to an iri or a uri must be performed only when absolutely necessary and as late as possible in a processing chain in particular neither the process of converting a relative leiri to an absolute one nor the process of passing a leiri to a process or software component responsible for dereferencing it should trigger percentencoding  characters allowed in legacy extended iris but not in iris this section provides a list of the groups of characters and code points that are allowed in legacy extedend iris but are not allowed in iris or are allowed in iris only in the query part for each group of characters advice on the usage of these characters is also given concentrating on the reasons not to use them space u some formats and applications use space as a delimiter for example for items in a list appendix c of rfc also mentions that white space may have to be added when displaying or printing long uris the same applies to long iris this means that spaces can disappear or can make the legacy extended iri to be interpreted as two or more separate iris delimiters  uc  ue and  u appendix c of rfc suggests the use of doublequotes httpexamplecom and angle brackets httpexamplecom as delimiters for uris in plain text these conventions are often used and also apply to iris legacy extended iris using these characters will be cut off at the wrong place unwise characters  uc  ue  u  ub  uc and  ud these characters originally have been excluded from uris because the respective codepoints are assigned to different graphic characters in some bit or bit encoding despite the move to unicode some of these characters are still occasionally displayed differently on some systems for example uc as a japanese yen symbol also the fact that these characters are not used in uris or iris has encouraged their use outside uris or iris in contexts that may include uris or iris in case a legacy extended iri with such a character is used in such a context the legacy extended iri will be interpreted piecemeal the controls c controls del and c controls u  uf uf  uf there is no way to transmit these characters reliably except potentially in electronic form even when in electronic form some software components might silently filter out some of these characters or may stop processing alltogether when encountering some of them these characters may affect text display in subtle unnoticable ways or in drastic global and irreversible ways depending on the hardware and software involved the use of some of these characters may allow malicious users to manipulate the display of a legacy extended iri and its context bidi formatting characters ue uf uae these characters affect the display ordering of characters displayed legacy extended iris containing these characters cannot be converted back to electronic form logical order unambiguously these characters may allow malicious users to manipulate the display of a legacy extended iri and its context specials uffffffd these code points provide functionality beyond that useful in a legacy extended iri for example byte order identification annotation and replacements for unknown characters and objects their use and interpretation in a legacy extended iri serves no purpose and may lead to confusing display variations private use code points uefff ufffffd u fffd display and interpretation of these code points is by definition undefined without private agreement therefore these code points are not suited for use on the internet they are not interoperable and may have unpredictable effects tags ueefff these characters provide a way to include language tags in unicode plain text they are not appropriate for legacy extended iris because language information in identifiers cannot reliably be input transmitted for example on a visual medium such as paper or recognized noncharacters ufddfdef ufffeffff ufffeffff ufffeffff ufffeffff ufffeffff ufffeffff ufffeffff ufffeffff ufffeffff uafffeaffff ubfffebffff ucfffecffff udfffedffff uefffeeffff uffffefffff ufffeffff these code points are defined as noncharacters applications may use some of them internally but are not prepared to interchange them for reference we here also list the code points and code units not even allowed in legacy extended iris surrogate code units ududfff these do not represent unicode codepoints a references rfc bradner s key words for use in rfcs to indicate requirement levels bcp  rfc  ietf march  available online as httptoolsietforghtmlbcp and httptoolsietforghtmlrfc rfc crocker d and p overell eds augmented bnf for syntax specifications abnf rfc std  ietf january  available online as httptoolsietforghtmlrfc rfc yergeau f utf a transformation format of iso  std  rfc  ietf november  available online as httptoolsietforghtmlrfc rfc bernerslee t r fielding and l masinter uniform resource identifier uri generic syntax std  rfc  ietf january  available online as httptoolsietforghtmlrfc rfc internationalized resource identifiers iris rfc drst m and m suignard eds ietf  available online as httptoolsietforghtmlrfc iribis internationalized resource identifiers iris draftduerstiribis drst m and m suignard eds ietf  available online as httptoolsietforghtmldraftduerstiribis